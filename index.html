<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADHD Reminder</title>
<style>
    /* Add your CSS styles here */
</style>
</head>
<body>
<div id="app">
    <button id="recordButton" onclick="toggleRecording()">Record</button>
    <button id="stopRecordingButton" style="display: none;" onclick="stopRecording()">Stop Recording</button>
    <button id="stopPlayingButton" style="display: none;" onclick="stopPlayingLoop()">Stop Playing Loop</button>
</div>

<script>
    let recorder;
    let audioChunks = [];
    let isRecording = false;
    let isPlaying = false;
    let audio;

    async function startRecording() {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        recorder = new MediaRecorder(stream);
        recorder.ondataavailable = e => {
            audioChunks.push(e.data);
            if (recorder.state === 'inactive') {
                const blob = new Blob(audioChunks, { type: 'audio/wav' });
                playAudio(blob);
            }
        };
        recorder.start();
        isRecording = true;
        updateButtonLabels();
    }

    function stopRecording() {
        if (recorder.state !== 'inactive') {
            recorder.stop();
        }
        isRecording = false;
        updateButtonLabels();
    }

    function playAudio(blob) {
        const audioURL = URL.createObjectURL(blob);
        audio = new Audio(audioURL);
        audio.loop = true;
        audio.play();
        isPlaying = true;
        updateButtonLabels();
        audio.onended = () => {
            setTimeout(() => {
                if (isPlaying) {
                    audio.play();
                }
            }, 60000); // 1 minute pause between loops
        };
    }

    function stopPlayingLoop() {
        if (isPlaying) {
            audio.pause();
            isPlaying = false;
            updateButtonLabels();
        }
    }

    function toggleRecording() {
        if (isRecording) {
            stopRecording();
        } else {
            startRecording();
        }
    }

    function updateButtonLabels() {
        const recordButton = document.getElementById('recordButton');
        const stopRecordingButton = document.getElementById('stopRecordingButton');
        const stopPlayingButton = document.getElementById('stopPlayingButton');

        if (isRecording) {
            recordButton.innerText = "Stop Recording";
            stopRecordingButton.style.display = 'inline';
            stopPlayingButton.style.display = 'none';
        } else if (isPlaying) {
            recordButton.innerText = "Record Again";
            stopRecordingButton.style.display = 'none';
            stopPlayingButton.style.display = 'inline';
        } else {
            recordButton.innerText = "Record";
            stopRecordingButton.style.display = 'none';
            stopPlayingButton.style.display = 'none';
        }
    }
</script>
</body>
</html>
