<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADHD Reminder</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
    }
    button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
    }
</style>
</head>
<body>

<h1>ADHD Reminder</h1>

<button id="recordBtn">Record Reminder</button>

<audio id="audioLoop" loop>
    <!-- Placeholder for audio source -->
</audio>

<p id="statusText"></p>

<script>
    let isRecording = false;
    let isPlaying = false;
    let audioLoop = document.getElementById('audioLoop');
    let recordBtn = document.getElementById('recordBtn');
    let statusText = document.getElementById('statusText');

    recordBtn.addEventListener('click', function() {
        if (isRecording) {
            // End recording
            isRecording = false;
            stopRecording();
        } else {
            // Start recording
            isRecording = true;
            startRecording();
        }
    });

    function startRecording() {
        if (isPlaying) {
            stopLoop();
        }
        recordBtn.textContent = 'End Recording';
        statusText.textContent = '';
        navigator.mediaDevices.getUserMedia({ audio: true })
        .then(function(stream) {
            let mediaRecorder = new MediaRecorder(stream);
            let chunks = [];
            mediaRecorder.ondataavailable = function(e) {
                chunks.push(e.data);
            }
            mediaRecorder.onstop = function() {
                let blob = new Blob(chunks, { 'type': 'audio/wav' });
                let audioUrl = URL.createObjectURL(blob);
                audioLoop.src = audioUrl;
                if (!isPlaying) {
                    startLoop();
                }
            }
            mediaRecorder.start();
            setTimeout(function() {
                mediaRecorder.stop();
            }, 3000); // Adjust recording duration as needed
        })
        .catch(function(err) {
            console.error('Error accessing microphone:', err);
        });
    }

    function stopRecording() {
        recordBtn.textContent = 'Record Reminder';
    }

    function startLoop() {
        isPlaying = true;
        audioLoop.play();
        statusText.textContent = 'Your task reminder is now playing every 30 seconds...';
        recordBtn.textContent = 'Stop Reminder';
    }

    function stopLoop() {
        isPlaying = false;
        audioLoop.pause();
        audioLoop.currentTime = 0;
        statusText.textContent = '';
        recordBtn.textContent = 'Record Reminder';
    }
</script>

</body>
</html>
